<!--pages/result/result.wxml-->
<view class="container">
  <!-- é‚€è¯·ç å¡ç‰‡ -->
  <view class="code-card" wx:if="{{isCreator}}">
    <view class="code-title">é‚€è¯·ç </view>
    <view class="code-value">{{code}}</view>
    <view class="code-actions">
      <button class="btn-action" bindtap="copyCode">å¤åˆ¶é‚€è¯·ç </button>
      <button class="btn-action btn-share" open-type="share">åˆ†äº«ç»™æœ‹å‹</button>
    </view>
  </view>
  
  <!-- å‚ä¸è€…ä¿¡æ¯ -->
  <view class="section" wx:if="{{gathering}}">
    <view class="section-header">
      <text class="section-title">å‚ä¸è€…ï¼ˆ{{gathering.participants.length}}äººï¼‰</text>
      <button class="btn-refresh" bindtap="refreshRecommendations">
        <text class="refresh-icon">ğŸ”„</text>
        <text>åˆ·æ–°æ¨è</text>
      </button>
    </view>
    
    <scroll-view class="participant-scroll" scroll-x>
      <view class="participant-list-h">
        <view class="participant-card" wx:for="{{gathering.participants}}" wx:key="temp_id">
          <view class="participant-avatar">{{item.nickname[0] || 'åŒ¿'}}</view>
          <view class="participant-info">
            <text class="participant-name">{{item.nickname || 'åŒ¿å'}}</text>
            <text class="participant-addr">{{item.location ? 'å·²å®šä½' : 'æœªå®šä½'}}</text>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>
  
  <!-- æ¨èç»“æœ -->
  <view class="section">
    <view class="section-title">æ¨èåœ°ç‚¹</view>
    
    <!-- åŠ è½½ä¸­ -->
    <view wx:if="{{isLoading}}" class="loading-box">
      <view class="loading">
        <text class="loading-text">æ­£åœ¨è®¡ç®—æœ€ä½³åœ°ç‚¹...</text>
      </view>
    </view>
    
    <!-- æ¨èåˆ—è¡¨ -->
    <view wx:elif="{{recommendations.length > 0}}" class="recommend-list">
      <view 
        class="recommend-item card" 
        wx:for="{{recommendations}}" 
        wx:key="id"
        bindtap="viewDetail"
        data-index="{{index}}"
      >
        <view class="recommend-header">
          <view class="recommend-rank">{{index + 1}}</view>
          <view class="recommend-content">
            <view class="recommend-name">{{item.name}}</view>
            <view class="recommend-address">{{item.address}}</view>
          </view>
        </view>
        
        <view class="recommend-stats">
          <view class="stat-item">
            <text class="stat-label">å¹³å‡é€šå‹¤</text>
            <text class="stat-value">{{item.avg_travel_time}}åˆ†é’Ÿ</text>
          </view>
          <view class="stat-item" wx:if="{{item.rating}}">
            <text class="stat-label">è¯„åˆ†</text>
            <text class="stat-value">{{item.rating}}åˆ†</text>
          </view>
          <view class="stat-item">
            <text class="stat-label">åŒ¹é…åº¦</text>
            <text class="stat-value">{{item.score}}%</text>
          </view>
        </view>
        
        <view class="recommend-actions">
          <button class="btn-navigate" catchtap="navigate" data-place="{{item}}">
            <text>å¯¼èˆª</text>
          </button>
        </view>
      </view>
    </view>
    
    <!-- æ— æ¨è -->
    <view wx:else class="empty-box">
      <text class="empty-text">éœ€è¦è‡³å°‘2ä¸ªäººçš„ä½ç½®ä¿¡æ¯æ‰èƒ½æ¨è</text>
      <text class="empty-hint">è¯·ç­‰å¾…æ›´å¤šæœ‹å‹åŠ å…¥å¹¶è®¾ç½®ä½ç½®</text>
    </view>
  </view>
  
  <!-- åº•éƒ¨æ“ä½œ -->
  <view class="bottom-bar">
    <button class="btn-home" bindtap="goHome">è¿”å›é¦–é¡µ</button>
    <button class="btn-share" open-type="share">é‚€è¯·æœ‹å‹</button>
  </view>
</view>